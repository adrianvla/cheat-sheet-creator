@page {
            size: A4;
            margin: 0;
        }
        html{
            background:#ccc;
            font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif
        }
        @media screen {
            body { 
                background: #e0e0e0;
                margin:auto;
                display:flex;
                justify-content:center;
                align-items:center;
                min-height: 100vh;
            }
        
            .page {
                background: white;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                border: 1px solid #000;
                box-sizing: border-box;
                position: relative;
            }
            .sheet-outer{
                display:flex;
                flex-direction: column;
                gap:50px;
                margin-top:50px;
                margin-bottom: 50px;
            }
        }

        .sheet-outer.A4.landscape { 
            width: 297mm;
            height: 210mm;
        }
        .sheet-outer.A4 { 
            width: 210mm;
            height: 297mm;
        }
        @media print {
            .page{
                margin: 0;
                /* border: 1px solid #000; */
            }
            body{
                margin:0;
                background:#fff;
                padding:0;
            }
            html{
                background:#fff;
            }
            .end{
                display:none;
            }
            .no-print {
                display: none !important;
            }
        }
        .page{
            page-break-after: always;
            height:100%;
            margin: 0;
            padding: 0;
        }
        .A4.landscape .page{
            width: 297mm;
            height: 210mm;
        }
    </style>
    <style>
        .grid {  
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr;
            gap: 0px 1px;
            grid-auto-flow: row;
            grid-template-areas:
                ". . .";
            background:#000;
            height:100%;
        }
        .col{
            height:100%;
            background:white;
            display:flex;
            flex-direction: column;
            position: relative;
        }
        .def{
            background-image: linear-gradient(45deg, #ffffff 45%, #ffc144 45.1%, #ffc144 50%, #ffffff 50.1%, #ffffff 95%, #ffc144 95.1%, #ffc144 100%);
            /* color removed to force black text on inside */
            opacity:0.9;
        }
        .thm{
            background-image: linear-gradient(45deg, #ffffff 45%, #ff44f6 45.1%, #ff44f6 50%, #ffffff 50.1%, #ffffff 95%, #ff44f6 95.1%, #ff44f6 100%);
            /* color removed */
            opacity:0.5;
        }
        .ideearg{
            background-image: linear-gradient(45deg, #ffffff 45%, #4a44ff 45.1%, #4a44ff 50%, #ffffff 50.1%, #ffffff 95%, #4a44ff 95.1%, #4a44ff 100%);
            /* color removed */
            opacity:0.5;
        }
        .res{
            background-image: linear-gradient(45deg, #ffffff 45%, #28c900 45.1%, #28c900 50%, #ffffff 50.1%, #ffffff 95%, #28c900 95.1%, #28c900 100%);
            /* color removed */
            opacity:0.6;
        }
        .divider{
            height:1px;
            background:#000;
        }
        .divider{
            position:relative;
            height:0px;
        }
        .divider:before{
            content: "";
            position:absolute;
            top:-1px;
            left:0;
            width:100%;
            height:1px;
            border-top:1px solid #000;
        }
        .sdivider{
            position:relative;
            height:0px;
        }
        .sdivider:before{
            content: "";
            position:absolute;
            top:-1px;
            left:0;
            width:100%;
            height:1px;
            border-top:1px dashed #000;
        }
        .double-divider{
            height:5px;
            box-sizing: border-box;
            border-top:1px solid #000;
            border-bottom:1px solid #000;
        }
        .block{
            background-size: 10px 10px;
            position:relative;
            display:flex;
            /* Alignment defaults handled in JS now */
            overflow: hidden; 
            cursor: pointer;
            transition: outline 0.1s;
        }
        .block:hover {
            outline: 2px solid #007bff;
            z-index: 10;
        }
        .important{
            border:2px dashed #000;
            box-sizing: border-box;
        }
        .inside{
            opacity:1;
            display: block;
            width: 100%;
            padding: 2px;
            box-sizing: border-box;
            white-space: normal;
            color: black !important;
            font-weight: 500;
        }
        
        /* UI Controls */
        #editModal {
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }
        #editModal::backdrop {
            background: rgba(0,0,0,0.5);
        }
        .form-group { margin-bottom: 10px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 8px; box-sizing: border-box; }
        .form-row { display: flex; gap: 10px; }
        .form-row .form-group { flex: 1; }
        
        .modal-actions { display: flex; justify-content: space-between; margin-top: 20px; }
        .btn { padding: 8px 16px; cursor: pointer; border: none; border-radius: 4px; }
        .btn-primary { background: #007bff; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-secondary { background: #6c757d; color: white; }

        .add-block-btn {
            width: 100%;
            height: 20px;
            background: rgba(0, 123, 255, 0.1);
            border: none;
            cursor: pointer;
            display: none; /* Show on hover of col */
            font-size: 12px;
            color: #007bff;
            text-align: center;
            line-height: 20px;
        }
        .col:hover .add-block-btn {
            display: block;
        }

        .tools {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: flex;
            gap: 10px;
            flex-direction: column;
        }